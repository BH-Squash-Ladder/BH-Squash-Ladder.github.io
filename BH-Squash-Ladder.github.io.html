import React, { useEffect, useState } from "react";


const SAMPLE_PLAYERS = [
{ id: "p1", name: "Alice" },
{ id: "p2", name: "Ben" },
{ id: "p3", name: "Carl" },
{ id: "p4", name: "Diane" },
{ id: "p5", name: "Eve" },
];


const STORAGE_KEY = "squash_ladder_v1";
const REQUESTS_KEY = "squash_requests_v1";


export default function SquashLadderApp() {
const [players, setPlayers] = useState(() => loadPlayers());
const [requests, setRequests] = useState(() => loadRequests());
const [showRequestModal, setShowRequestModal] = useState(false);
const [selectedChallenger, setSelectedChallenger] = useState("");
const [selectedTarget, setSelectedTarget] = useState("");
const [notes, setNotes] = useState("");
const [isAdmin, setIsAdmin] = useState(false);
const [adminPass, setAdminPass] = useState("");
const [filter, setFilter] = useState("");


useEffect(() => savePlayers(players), [players]);
useEffect(() => saveRequests(requests), [requests]);


function loadPlayers() {
try {
const raw = localStorage.getItem(STORAGE_KEY);
if (raw) return JSON.parse(raw);
} catch (e) {}
// seed with sample players
return SAMPLE_PLAYERS;
}


function savePlayers(list) {
localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
}


function loadRequests() {
try {
const raw = localStorage.getItem(REQUESTS_KEY);
if (raw) return JSON.parse(raw);
} catch (e) {}
return [];
}


function saveRequests(list) {
localStorage.setItem(REQUESTS_KEY, JSON.stringify(list));
}


function openRequestModal() {
setSelectedChallenger(players[0]?.id || "");
setSelectedTarget(players[1]?.id || "");
setNotes("");
setShowRequestModal(true);
}


function submitRequest(e) {
e.preventDefault();
if (!selectedChallenger || !selectedTarget) return;
if (selectedChallenger === selectedTarget) return alert("Choose two different players.");
const request = {
id: `r_${Date.now()}`,
challenger: selectedChallenger,
target: selectedTarget,
notes,
createdAt: new Date().toISOString(),
status: "pending",
